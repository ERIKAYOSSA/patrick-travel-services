(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1270],{13620:(e,t,r)=>{"use strict";r.d(t,{F:()=>l});var s=r(86739);function a(){let e=(0,s._)(["\n  flex flex-col flex-grow w-full first:mt-0 last:mb-0\n"]);return a=function(){return e},e}let l=r(36609).qy.section(a())},17710:(e,t,r)=>{"use strict";r.d(t,{Bx:()=>b,uk:()=>x,s2:()=>f});var s=r(86739),a=r(50979),l=r(13025),n=r(25963),i=r(36609);let o={list:{visible:{transition:{staggerChildren:.05}}}};var d=r(70375),c=r(49852),u=r(13077),m=r(47654);r(37590);var h=r(42419);let x=e=>{let{text:t,link:r,active:s,icon:l,highlightSubPath:o}=e,[m,x,p]=(0,c.y)({rotate:35}),{pathname:v}=(0,d.c)(),b=(0,n.useMemo)(()=>null!=s?s:o?v.startsWith(r.url):v===r.url,[s,v,r.url,o]);return(0,a.jsxs)(g,{active:b,...r,scroll:!1,className:"sidebar-item sidebar-item-".concat(t.replace(/\s+/g,"-")," group mb-2 space-x-3"),onMouseEnter:p,children:[null!=l&&(0,a.jsx)(u.In,{icon:l,size:"sm",initial:{rotate:0},animate:m,transition:x,className:(0,i.xW)(b?"text-primary group-hover:text-primary":"text-gray-300 group-hover:text-neutral-secondary")}),(0,a.jsx)(h.EY,{className:"text-md",children:t})]})},g=e=>{let{active:t,className:r,...s}=e;return(0,a.jsx)(m.N,{...s,className:(0,i.xW)("relative flex items-center md:px-2 py-1 rounded text-neutral-secondary",t&&"text-neutral font-medium md:hover:text-neutral","md:hover:bg-secondaryBg hover:text-neutral-secondary",r)})};function p(){let e=(0,s._)(["pt-0 mb-6"]);return p=function(){return e},e}function v(){let e=(0,s._)(["\n  w-full pt-4 md:w-sidebar md:min-w-sidebar\n  md:sticky md:top-4 h-max\n"]);return v=function(){return e},e}let b=e=>{let{children:t,...r}=e;return(0,a.jsx)(y,{className:"sidebar",...r,children:t})},f=e=>{let{children:t,shouldAnimate:r,...s}=e;return(0,a.jsx)(j,{initial:r?"hidden":"visible",animate:"visible",variants:o.list,...s,children:t})},j=(0,i.DR)(l.P.div)(p()),y=i.qy.aside(v())},18970:(e,t,r)=>{"use strict";r.d(t,{$o:()=>y,A3:()=>f,D1:()=>p,J6:()=>x,XI:()=>g,fI:()=>b,vc:()=>v,xC:()=>j});var s=r(86739),a=r(50979);r(25963);var l=r(2551),n=r(31754),i=r(95662),o=r(42419),d=r(36609);function c(){let e=(0,s._)(["grid grid-cols-[minmax(0,1fr)] overflow-x-auto flex-grow rounded-lg border border-gray-200"]);return c=function(){return e},e}function u(){let e=(0,s._)(['\n    "[&>tr]:border [&>tr]:border-b [&>tr]:border-gray-100 [&>tr]:bg-transparent [&>tr]:hover:bg-transparent"\n']);return u=function(){return e},e}function m(){let e=(0,s._)(["py-3 px-4 text-left font-semibold text-xs text-gray-600"]);return m=function(){return e},e}function h(){let e=(0,s._)(["flex items-center justify-center pt-4"]);return h=function(){return e},e}let x=d.qy.div(c()),g=(0,d.Wp)("table")(e=>["w-full border-collapse",e.isSelecting?"select-none":"select-auto"]),p=(0,d.Wp)("thead")(u()),v=(0,d.Wp)("tbody")(e=>[e.showRowBorder&&"[&>tr]:border-b [&>tr]:border-gray-100 [&>tr:last-child]:border-none"]),b=(0,d.Wp)("tr")(e=>[e.isInserting&&"border-t-2 border-pink-500",e.unSelectable&&"[&>tr]:cursor-initial",e.isActive&&"bg-gray-100","[&.selected]:bg-gray-100 [&.inserting]:bg-transparent",e.unSelectable||!1===e.isActive?"hover:bg-transparent":"hover:bg-gray-100"]),f=d.qy.th(m()),j=(0,d.Wp)("td")(()=>["py-3 px-4 cursor-pointer overflow-hidden overflow-ellipsis whitespace-nowrap"],e=>({width:e.width,minWidth:64,maxWidth:400,textAlign:e.align})),y=e=>{let{canPreviousPage:t,canNextPage:r,pageIndex:s,totalPages:n,gotoPage:i,previousPage:d,nextPage:c,...u}=e;return(0,a.jsxs)(w,{space:2,...u,children:[(0,a.jsx)(k,{type:"button",title:"First Page",icon:l.O_5,isHidden:!t,onClick:()=>i(0)}),(0,a.jsx)(k,{type:"button",title:"Previous Page",icon:l.JGc,isHidden:!t,onClick:()=>d()}),(0,a.jsxs)(o.EY,{className:"text-sm whitespace-nowrap",children:["Page ",s+1," ",null!=n&&(0,a.jsxs)(a.Fragment,{children:["of ",n]})]}),(0,a.jsx)(k,{type:"button",title:"Next Page",icon:l.c_$,isHidden:!r,onClick:()=>c()}),(0,a.jsx)(k,{type:"button",icon:l.hIh,title:"Last Page",isHidden:null==n||!r,onClick:()=>{null!=n&&i(n-1)}})]})},w=(0,d.DR)(i.z)(h()),k=(0,d.DR)(n.K0)(e=>[e.isHidden?"invisible":"visible"])},21512:(e,t,r)=>{"use strict";r.d(t,{Hl:()=>g,Q5:()=>x,s6:()=>h});var s=r(25963),a=r(22986),l=r(45588),n=r(97865),i=r(72898),o=r(55850),d=r(45479),c=r(5979),u=r(66800),m=r.n(u);let h=[{value:d.acM.Admin,text:"Admin"},{value:d.acM.Member,text:"Member"},{value:d.acM.Viewer,text:"Deployer"}],x=e=>{let[{user:t}]=(0,l.Jd)(),{graphqlClient:r}=(0,o.q)(),c=["team",e,"members",null==t?void 0:t.id],u=(0,a.useRouter)(),{result:h,setQuery:x}=(0,n.W)(c,async()=>{if(t&&!e)return[{id:t.id,role:d.acM.Admin,featureFlags:t.featureFlags,name:t.name,email:t.email,avatar:t.avatar}];if(e)return(await r.teamMembers({id:e})).team.members;throw Error("userId and teamId not defined")},{staleTime:m()("30s"),enabled:u.isReady}),g=(0,s.useMemo)(()=>{var e,r,s;return null!=(s=null==(r=h.data)||null==(e=r.find(e=>e.id===(null==t?void 0:t.id)))?void 0:e.role)?s:null},[h.data,t]),p=(0,i.n)(c,async s=>{let{userId:a,role:l}=s;null!=t&&null!=e&&null!=h.data&&(x(h.data.map(e=>e.id===a?{...e,role:l}:e)),await r.teamPermissionChange({input:{teamId:e,userId:a,role:l}}))}),v=(0,i.n)(c,async s=>{null!=t&&null!=e&&null!=h.data&&(x(h.data.filter(e=>e.id!==s)),await r.teamUserRemove({id:e,input:{userId:s}}))});return{teamMembers:h,currentRole:g,teamMemberActions:{changeTeamPermission:p,removeUserFromTeam:v}}},g=e=>{let{graphqlClient:t}=(0,o.q)(),r=["team",e,"trustedDomains"],{result:s,setQuery:a}=(0,n.W)(r,async()=>{if(null==e)throw Error("teamId not defined");return(0,c.nX)(await t.teamTrustedDomains({teamId:e})).teamTrustedDomains},{enabled:null!=e});return{teamTrustedDomains:s,teamTrustedDomainActions:{createTeamTrustedDomain:(0,i.n)(r,async r=>{if(null==e)throw Error("teamId not defined");return await t.createTeamTrustedDomain({input:{...r,teamId:e}}),!0}),deleteTeamTrustedDomain:(0,i.n)(r,async r=>{let{id:s}=r;if(null==e)throw Error("teamId not defined");return await t.deleteTeamTrustedDomain({id:s}),!0})}}}},25646:(e,t,r)=>{"use strict";r.d(t,{j:()=>l});var s=r(50979),a=r(28443);let l=e=>{let{triggerContent:t,cardContent:r}=e;return(0,s.jsxs)(a.bL,{children:[(0,s.jsx)(a.l9,{children:t}),(0,s.jsx)(a.ZL,{children:(0,s.jsxs)(a.UC,{className:"z-40 relative shadow-lg bg-secondaryBg p-4 rounded-lg text-foreground font-sans",children:[r,(0,s.jsx)(a.i3,{})]})})]})}},28531:(e,t,r)=>{"use strict";r.d(t,{S:()=>u});var s=r(50979),a=r(45479),l=r(70375),n=r(73648),i=r(21512),o=r(2551),d=r(42419),c=r(17710);let u=()=>{let{routes:e}=(0,l.c)(),{workspace:t}=(0,n.hA)(),{currentRole:r}=(0,i.Q5)(null==t?void 0:t.teamId),u=null!=r;return(0,s.jsxs)(c.s2,{children:[(0,s.jsx)(d.zb,{className:"font-semibold text-xs mb-2 mx-1",children:"WORKSPACE"}),(0,s.jsx)(c.uk,{text:"General",link:e.workspace({}),icon:o.wB_}),u&&(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(c.uk,{text:"People",link:e.workspacePeople({}),icon:o.zWC})}),((null==t?void 0:t.teamId)==null||r===a.acM.Admin)&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c.uk,{text:"Plans",icon:o.cwJ,link:e.workspacePlan({})}),(0,s.jsx)(c.uk,{text:"Usage",link:e.workspaceUsage({}),icon:o.EsT}),(0,s.jsx)(c.uk,{text:"Billing",link:e.workspaceBilling({}),icon:o.y5g})]}),u&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c.uk,{text:"Earnings",link:e.workspaceEarnings({}),icon:o.G9t}),(0,s.jsx)(c.uk,{text:"Templates",link:e.workspaceTemplates({}),icon:o.PEP}),(0,s.jsx)(c.uk,{text:"Referrals",link:e.workspaceReferrals({}),icon:o.pD})]})]})}},32357:(e,t,r)=>{"use strict";r.d(t,{j:()=>f});var s=r(50979),a=r(25963),l=r(19391),n=r(37111),i=r(40974),o=r.n(i),d=r(63344),c=r(31754),u=r(2551),m=r(8718),h=r(13077),x=r(95662),g=r(13025),p=r(42419),v=r(6008),b=r(36609);let f=a.forwardRef((e,t)=>{let{value:r,defaultOpen:i,options:o,onChange:p,onSelect:f,icon:y,iconText:w,overflowHint:I,behavior:C="insert",minQueryLength:S=1,className:M,portalContainer:T,iconContainerClassName:z,includeFullMatch:D,...U}=e,E=(0,a.useRef)(null),[R,P]=(0,a.useState)(null),W=(0,a.useMemo)(()=>{let e=[];for(let t of o){let s=0,a=0;for(;(a=r.indexOf(t.value,s))>-1;)e.push({start:a,end:a+t.value.length}),s=a+t.value.length}return e},[r]);(0,a.useImperativeHandle)(t,()=>R);let[_,B]=(0,a.useState)(!1),[A,F]=(0,a.useState)(!1),[L,V]=(0,a.useState)(null),[O,G]=(0,a.useState)(0),[Y,H]=(0,a.useState)(0),[K,q]=(0,a.useState)(null!=r?r:"");(0,a.useEffect)(()=>{i&&B(!0)},[]),(0,a.useEffect)(()=>{B(_||i||!1)},[i]);let{prefix:J,suffix:$,matchedOptions:Q,selectableOptions:X}=(0,a.useMemo)(()=>{let e=K.slice(0,null!=O?O:0),t=K.slice(null!=Y?Y:0,K.length),{results:r,hasValidQuery:s}=k({options:o,prefix:e,suffix:t,minQueryLength:_?1:S,includeFullMatch:D}),a=s?r:o.filter(e=>{var t;return(null!=(t=e.numMatchStart)?t:0)<=1}).map(e=>({obj:e,query:"",score:0,target:e.value}));return{prefix:e,suffix:t,matchedOptions:r,selectableOptions:a}},[K,O,Y,_,JSON.stringify(o)]);(0,a.useEffect)(()=>{if(null!=R)return(0,m.Ay)(R,{Enter:e=>{if(0===X.length)return void B(!1);!_||e.shiftKey||e.ctrlKey||e.metaKey||e.altKey||(e.preventDefault(),e.stopPropagation(),null!==L&&L<X.length&&ee(X[L]))},ArrowUp:e=>{var t,r;if(!_)return;e.preventDefault(),V(e=>null===e?0:e-1);let s=(null!=(r=null==(t=E.current)?void 0:t.querySelectorAll("."+j.className))?r:[])[(null!=L?L:-1)-1];null==s||s.scrollIntoView({block:"nearest"})},ArrowDown:e=>{var t,r;if(!_)return;e.preventDefault(),V(e=>null===e?0:e+1);let s=(null!=(r=null==(t=E.current)?void 0:t.querySelectorAll("."+j.className))?r:[])[(null!=L?L:-1)+1];null==s||s.scrollIntoView({block:"nearest"})},Escape:e=>{_&&(e.stopPropagation(),er())},"Control+Space":e=>{_||(e.preventDefault(),et())}})},[R,_,L,X]),(0,a.useEffect)(()=>{0!==X.length&&null!=L&&(L<0?V(0):L>X.length-1&&V(X.length-1))},[L,X]),(0,a.useEffect)(()=>{!_&&Q.length>0&&et()},[Q.length,X.length]),(0,a.useEffect)(()=>{let e=()=>B(!1);return document.addEventListener("scroll",e),()=>document.removeEventListener("scroll",e)},[]);let Z=e=>{0===e.length&&K.length>0&&er(),q(e),p(e)},ee=e=>{var t;let r=null!=(t=e.query.length)?t:0,s=J.slice(0,J.length-r)+e.target,a="replace"===C?e.target:s+$;null!=R&&(R.value=a,R.setSelectionRange(s.length,s.length,"forward"),G(R.selectionStart),H(R.selectionEnd),R.focus()),Z(a),er(),null==f||f(e.obj)},et=()=>{_||(V(0),B(!0),null==R||R.focus())},er=()=>{_&&(B(!1),F(!1))},[es,ea]=(0,a.useState)(),el=(0,v.l)(100),{positionStyles:en,numToShow:ei}=(0,a.useMemo)(()=>{let e=null==R?void 0:R.getBoundingClientRect();if(null==e)return{numToShow:1/0};let t=Math.min(600,window.innerHeight-e.bottom-30),r=Math.floor(t/37-1);return I&&(r-=1),(A||r<3)&&(r=1/0),{numToShow:r,positionStyles:{top:"".concat(e.bottom,"px"),left:"".concat(e.left,"px"),minWidth:"".concat(e.width,"px"),maxHeight:"".concat(t,"px")}}},[R,_,A,el]);return(0,s.jsxs)("div",{className:"relative w-full",children:[(0,s.jsx)(d.T,{name:U.name,ref:P,highlights:W,enterToSubmit:!0,autoComplete:"off",spellCheck:!1,...U,value:r,onChange:e=>Z(e.currentTarget.value),onBlur:()=>{null!=es&&clearTimeout(es),ea(setTimeout(er,400))},onFocus:()=>{null!=es&&clearTimeout(es)},onSelect:e=>{G(e.currentTarget.selectionStart),H(e.currentTarget.selectionEnd)},className:(0,b.xW)("resize-none max-h-[30vh] !pr-7",M),textareaSiblings:(0,s.jsx)(s.Fragment,{children:y&&(0,s.jsx)(c.$n,{"aria-hidden":!0,tabIndex:-1,variant:"primary",title:"Open",size:"md"===U.size?"sm":"xs",type:"button",color:"gray",onClick:et,className:(0,b.xW)("z-10 absolute right-0 top-0 mt-1 mr-1 !bg-gray-100 border-0 text-gray-600 hover:text-gray-900",z),children:(0,s.jsxs)(x.z,{align:"center",children:[(0,s.jsx)(h.In,{icon:y,size:"xs",className:"!h-[14px] !w-[14px]"}),(0,s.jsx)(g.P.div,{animate:!r&&w?{marginLeft:"0.2rem"}:{marginLeft:0,opacity:0,width:0},className:"overflow-hidden whitespace-nowrap",children:w})]})})})}),_&&(0,s.jsxs)(l.b,{"aria-hidden":!0,container:T,children:[(0,s.jsx)("div",{onClick:er,className:"fixed top-0 left-0 right-0 bottom-0 z-50"}),(0,s.jsx)("div",{ref:E,style:en,className:"fixed z-50 bg-background shadow-md dark:bg-gray-100 rounded border border-gray-200 mt-0.5 flex",children:(0,s.jsxs)(n.F,{thumbCSS:"brightness-95 dark:brightness-125",className:"h-auto w-full p-2",onScroll:e=>e.stopPropagation(),children:[0===X.length&&(0,s.jsx)(N,{className:"text-gray-500 italic py-0",children:"No suggestions"}),I&&X.length>ei&&(0,s.jsxs)(N,{className:"text-gray-500",children:[(0,s.jsx)(h.In,{icon:u.R2D,size:"sm",className:"mr-2"}),(0,s.jsx)("span",{className:"text-xs",children:I})]}),X.slice(0,A?-1:ei).map(e=>(0,s.jsx)(j,{hint:e.obj.hint,isFocused:null!==L&&X[L]===e,onClick:()=>{ee(e)},onHover:()=>V(X.indexOf(e)),onBlur:()=>V(null),textBeforeCursor:J,result:e},e.obj.value+e.obj.hint)),X.length>ei&&(0,s.jsxs)(N,{hoverStyles:!0,onClick:e=>{e.stopPropagation(),e.preventDefault(),F(!0),null==R||R.focus()},className:"text-gray-500",children:[(0,s.jsx)(h.In,{icon:u.a4,size:"sm",className:"mr-2"}),(0,s.jsxs)("span",{className:"text-sm",children:["Show ",X.length-ei," More"]})]})]})})]})]})}),j=e=>{let{isFocused:t,onClick:r,onHover:a,onBlur:l,result:n,hint:i,textBeforeCursor:d,...c}=e;return(0,s.jsxs)(N,{hasFocus:t,className:j.className,onClick:e=>{e.preventDefault(),e.stopPropagation(),r()},onMouseEnter:a,onMouseLeave:l,...c,children:[n.obj.icon&&(0,s.jsx)(h.In,{icon:n.obj.icon,size:"sm",className:"mr-2 text-gray-500"}),(0,s.jsx)("div",{className:"font-mono text-gray-600",children:null!=n._indexes?o().highlight(n,(e,t)=>(0,s.jsx)("span",{className:"underline",children:e},t)):n.target}),null!=i&&(0,s.jsx)(p.ax,{className:"pl-8 ml-auto text-gray-500",children:i})]})};j.className="autocomplete-item";let y=(e,t,r)=>{let s="";for(let a=0;a<e.length;a++){let l=e.length-1-a,n=e[l];if(r&&e.slice(l,l+r.length)===r)break;if(s=n+s,t&&e.slice(l,l+t.length)===t)return s}return""},w=(e,t,r)=>{for(let s=0;s<e.length;s++)if(r&&e.slice(s-r.length,s)===r||t&&e.slice(s-t.length,s)===t)return!1;return!0},k=e=>{let{options:t,prefix:r,suffix:s,minQueryLength:a,includeFullMatch:l=!1}=e,n=[],i=!1;for(let e of t){var d,c;let t=e.value.slice(0,null!=(d=e.numMatchStart)?d:1),u=e.value.slice(-(null!=(c=e.numMatchStop)?c:0));if(!w(s,t,u))continue;let m=""===t?r:y(r,t,u);if(m.length<a||!l&&e.value.length===m.length)continue;i=!0;let h=o().single(m,e.value);null!==h&&n.push({...h,obj:e,query:m})}return{results:n,hasValidQuery:i}},N=(0,b.Wp)("div")(e=>["w-full px-2 py-2 text-sm rounded-md flex items-center cursor-default",e.hasFocus&&"bg-gray-100 dark:bg-gray-200",e.hoverStyles&&"hover:bg-gray-100 dark:hover:bg-gray-200"])},35356:(e,t,r)=>{"use strict";r.d(t,{P:()=>i});var s=r(50979),a=r(75749),l=r(95662),n=r(42419);let i=e=>{let{title:t,ActionComponent:r,space:i=12,children:o}=e;return(0,s.jsxs)(l.T,{space:i,className:"w-full",children:[(0,s.jsxs)(l.z,{align:"center",justify:"between",children:[(0,s.jsx)(n.fV,{className:"font-normal",children:t}),r&&(0,s.jsx)(r,{})]}),(0,s.jsx)(a.c,{}),o]})}},43479:(e,t,r)=>{"use strict";r.d(t,{U:()=>o});var s=r(50979),a=r(70375),l=r(42419),n=r(2551),i=r(17710);let o=()=>{let{routes:e}=(0,a.c)();return(0,s.jsxs)(i.s2,{children:[(0,s.jsx)(l.zb,{className:"font-semibold text-xs mb-2 mx-1",children:"PERSONAL"}),(0,s.jsx)(i.uk,{text:"Account",link:e.account({}),icon:n.KJW}),(0,s.jsx)(i.uk,{text:"Notifications",link:e.accountNotifications({}),icon:n.IrQ}),(0,s.jsx)(i.uk,{text:"Feature Flags",link:e.accountFeatureFlags({}),icon:n.lNU}),(0,s.jsx)(i.uk,{text:"Tokens",link:e.accountTokens({}),icon:n.Uzy}),(0,s.jsx)(i.uk,{text:"Security",link:e.accountSecurity({}),icon:n.c_I})]})}},44364:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[projectId]/observability",function(){return r(53519)}])},44661:(e,t,r)=>{"use strict";r.d(t,{S:()=>u});var s=r(50979),a=r(687),l=r(25963),n=r(71144),i=r(2551),o=r(13077),d=r(36609),c=r(76933);function u(e){let{disabled:t=!1,id:r,label:u,onChange:m,checked:h=!1,size:x="md",value:g,tooltip:p}=e,{track:v}=(0,n.j)(),b=(0,l.useCallback)(e=>{m&&(v({action:"Toggle",object:"checkbox",properties:{isChecked:e,id:r}}),m(!!e))},[m]),f=(0,d.xW)(["rounded","border","inline-flex items-center justify-center cursor-pointer","focus:outline-none focus-visible:ring-2 focus-visible:ring-pink-400","rdx-state-checked:bg-pink-500 border-pink-500","rdx-state-unchecked:border-gray-300","rdx-disabled:opacity-50","xs"===x&&"h-4 w-4","sm"===x&&"h-5 w-5","md"===x&&"h-6 w-6"]),j=(0,d.xW)(["text-white","xs"===x&&"h-3 w-3","sm"===x&&"h-4 w-4 p-0.5","md"===x&&"h-5 w-5 p-0.5"]),y=(0,d.xW)(["pl-3 select-none text-base cursor-pointer",t&&"opacity-50","xs"===x&&"text-xs","sm"===x&&"text-sm","md"===x&&"text-base",p&&"border-b border-dashed border-gray-300"]);return(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(a.bL,{"aria-labelledby":"".concat(r,"-label"),checked:h,className:f,disabled:t,id:r,value:g,onCheckedChange:b,children:(0,s.jsx)(a.C1,{children:(0,s.jsx)(o.In,{className:j,icon:i.Jlk,size:x})})}),u&&(0,s.jsx)(s.Fragment,{children:p?(0,s.jsx)(c.m,{side:"top",content:(0,s.jsx)(s.Fragment,{children:p}),children:(0,s.jsx)("label",{className:y,htmlFor:r,id:"".concat(r,"-label"),children:u})}):(0,s.jsx)("label",{className:y,htmlFor:r,id:"".concat(r,"-label"),children:u})})]})}},46348:(e,t,r)=>{"use strict";r.d(t,{N:()=>l});var s=r(86739);function a(){let e=(0,s._)(["\n  mt-12 mb-24\n  block space-y-4\n  md:flex md:space-x-12 md:space-y-0\n"]);return a=function(){return e},e}let l=r(36609).qy.div(a())},53519:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>ts});var s=r(50979),a=r(81154),l=r(67970),n=r(95662);r(45712),r(32847);var i=r(25963),o=r(7776),d=r(38478),c=r(52992),u=r(2551),m=r(12645),h=r(31754),x=r(42113),g=r(86559),p=r(45479),v=r(44039),b=r(32507),f=r(15857),j=r(97865),y=r(55850);let w={h:3,w:6,x:0,y:0},k=()=>{let e=(0,a.md)(f.T6),t=(0,a.md)(v.vA),{serviceInstances:r,volumeInstances:s}=(0,a.md)(b.Bo);return(0,i.useMemo)(()=>{if(null==e)return{services:[],volumes:[]};let a=r.map(e=>e.serviceId),l=e.services.filter(e=>a.includes(e.id)),n=s.map(e=>e.volumeId),i=e.volumes.filter(e=>n.includes(e.id));return{services:l.map(e=>{var r,s,a,l;let n=null==t||null==(r=t.services)?void 0:r[e.id],i=(null==n||null==(s=n.source)?void 0:s.image)!=null?u.azJ:(null==n||null==(a=n.source)?void 0:a.repo)!=null?u.gqo:u.BKt;return{id:e.id,name:e.name,icon:null!=(l=e.icon)?l:i}}),volumes:i.map(e=>({id:e.id,name:e.name}))}},[e,r,s,t])};var N=r(6008),I=r(32357),C=r(61259),S=r(86954),M=r(10733),T=r(42419),z=r(88854),D=r(21531),U=r.n(D),E=r(17851),R=r(17057),P=r(13077),W=r(93208),_=r(81213),B=r(6605),A=r(70375),F=r(65870),L=r(11028),V=r(54940),O=r(62561),G=r(4750),Y=r(38814),H=r(91035),K=r(91378);let q=e=>{var t;let{metrics:r,measurement:a,height:l,monitors:n}=e,{routes:o,navActions:c}=(0,A.c)(),[u]=(0,d.f$)(),m=(0,H.pZ)({metrics:{values:r.flatMap(e=>e.values),measurement:a},limitMetrics:void 0,yMin:.5,yPadding:.1}),h=(0,i.useMemo)(()=>{let e=r.flatMap(e=>e.values).map(e=>e.value);return(0,_.A)(e)},[r]),x=null!=(t=null==n?void 0:n.map(e=>{var t;return{direction:"horizontal",value:null!=(t=e.config.threshold)?t:0,label:"threshold"in e.config?"Threshold":"",color:e.alerts.some(e=>!e.resolvedAt)?"red":"gray",strokeDashArray:"2,4",renderTooltip:e=>(0,s.jsx)(V.H,{label:e.guide.label,value:(0,O.s)({measurement:a,value:e.guide.value}),color:e.guide.color})}}))?t:[],g=m;switch(a){case p.zc2.NetworkTxGb:case p.zc2.NetworkRxGb:g=[0,h]}x.length>0&&(g[1]=Math.max(g[1],...x.map(e=>1.02*e.value)));let v=(0,i.useMemo)(()=>r.map(e=>({data:e.values,label:e.label,colour:e.colour})),[r]);return(0,s.jsx)(L.b,{legend:!0,lines:v,guides:x,xAxis:{getValue:e=>new Date(1e3*e.ts),dateFormat:u.dateFormat,tickTransform:"translate(0, 0)"},yAxis:{getValue:e=>e.value,renderValue:e=>(e=>{let{measurement:t,value:r}=e;switch(t){case p.zc2.MemoryUsageGb:case p.zc2.NetworkTxGb:case p.zc2.NetworkRxGb:case p.zc2.DiskUsageGb:case p.zc2.BackupUsageGb:return(0,F.s)(r);case p.zc2.CpuUsage:return"".concat(r.toFixed(1)," vCPU");default:return r.toString()}})({measurement:a,value:e}),domain:g},onLineClick:(e,t,s)=>{if(!s.altKey)return;let a=r[t];a&&(a.serviceId?c.push(o.projectServiceMetrics({serviceId:a.serviceId})):a.volumeId&&c.push(o.projectVolumeMetrics({volumeId:a.volumeId})))},renderTooltip:e=>(0,s.jsx)(V.H,{label:e.line.label,value:(0,O.s)({value:e.yValue,measurement:a}),color:e.line.colour,timestamp:e.xValue,children:(0,s.jsxs)("div",{className:"border-t border-t-neutral-light dark:border-t-neutral text-xs py-2 px-3",children:[(0,s.jsx)("span",{className:"rounded-md bg-neutral-surface dark:bg-neutral-surface-hover py-px inline-block px-1",children:B.KE})," ",(0,s.jsx)("span",{className:"rounded-md bg-neutral-surface dark:bg-neutral-surface-hover py-px inline-block px-1",children:"click"})," ","to jump to service"]})}),renderCustomElements:e=>(0,s.jsx)(s.Fragment,{children:null==n?void 0:n.map(t=>t.alerts.map(t=>(0,s.jsx)(K.n,{...e,alert:t},t.id)).filter(Boolean))}),chartStyle:{showBorder:!1,showArea:!1,showHover:!0},height:l})},J=e=>e===p.xW4.ServiceMetricsItem?"serviceId":"volumeId",$=e=>{let{type:t,resourceIds:r,measurements:l,height:o,environmentId:c,monitors:u,isResizing:m}=e,{resourceColorMap:h}=(0,a.md)(eK),{result:x}=(e=>{let{environmentId:t,measurements:r,groupBy:s}=e,{graphqlClient:a}=(0,y.q)(),[l]=(0,d.f$)();return(0,j.W)(["observabilityItem",t,l.display,...null!=r?r:[],...null!=s?s:[]],async()=>(await a.observabilityItem({...(0,d.yc)({timeRange:l}),environmentId:t,measurements:r,groupBy:s})).metrics,{retry:!1,refetchInterval:1e3*d.py})})({environmentId:c,measurements:l,groupBy:[p.xfK.ServiceId,p.xfK.VolumeId,p.xfK.VolumeInstanceId]}),g=(0,a.md)(f.T6),v=(0,i.useMemo)(()=>l[0],[l]),b=(0,i.useMemo)(()=>{if(null==x.data||null==g)return null;let e=x.data.filter(e=>{if(e.measurement!==v)return!1;let s=J(t),a=e.tags[s];return null==a||r.includes(a)||0===r.length});return e.filter(e=>{let r=J(t),s=e.tags[r];return null!=s&&(g.services.some(e=>e.id===s)||g.volumes.some(e=>e.id===s))}).map(r=>{let s,a=J(t),l=r.tags[a];if("serviceId"===a){let e=g.services.find(e=>e.id===l);s=null==e?void 0:e.name}if("volumeId"===a){let t=g.volumes.find(e=>e.id===l),a=Math.min(...r.values.map(e=>{let{ts:t}=e;return t})),n=e.some(e=>e.tags.volumeId===l&&e.tags.volumeInstanceId!==r.tags.volumeInstanceId);s="".concat(null==t?void 0:t.name).concat(n?" (".concat(X.format(new Date(1e3*a)).replace(",",""),")"):"")}let n=null!=l&&h.has(l)?h.get(l):G.sZ;return{values:r.values,label:s,serviceId:"serviceId"===a?l:void 0,volumeId:"volumeId"===a?l:void 0,colour:n}})},[x.data,v,g,r,t,h]);return x.isLoading||m?(0,s.jsx)(Y.t,{}):null==b||0===b.length?(0,s.jsxs)(n.T,{justify:"center",space:1,className:"text-center",style:{height:o},children:[(0,s.jsx)(T.xC,{className:"font-semibold",children:"No data available"}),(0,s.jsx)(T.xC,{children:"We do not have any data for the selected service/metric combo in the active environment."})]}):(0,s.jsx)(q,{metrics:b,measurement:v,height:o,monitors:u})},Q=window.navigator.language,X=new Intl.DateTimeFormat(Q,{dateStyle:"short",timeStyle:"short"});var Z=r(4766),ee=r(46376),et=r(57092);let er=e=>{var t,r,a,l;let{projectUsageProperties:n,projectId:o}=e,[c]=(0,d.f$)(),u=(0,i.useMemo)(()=>{var e;return c?{start:new Date(c.getStartDate()),end:new Date((null==(e=c.getEndDate)?void 0:e.call(c))||new Date().toISOString())}:null},[c]),{result:m}=(0,et.m)({projectId:o,billingPeriod:u}),h=null!=(a=null==(t=m.data)?void 0:t.currentUsage)?a:Z.EMPTY_USAGE_ITEM,x=null!=(l=null==(r=m.data)?void 0:r.estimatedUsage)?l:Z.EMPTY_USAGE_ITEM;return(0,s.jsxs)("div",{className:"h-full grid gap-4 grid-cols-2 @2xl:grid-cols-3 overflow-x-hidden overflow-y-auto scrollbar-hide",children:[n.includes(p.Y3B.CurrentUsage)&&(0,s.jsx)(ee.BillItemInfo,{text:"Current usage",value:(0,Z.costForUsageItem)(h)}),n.includes(p.Y3B.EstimatedUsage)&&(0,s.jsx)(ee.BillItemInfo,{text:"Estimated usage",value:(0,Z.costForUsageItem)(x)}),n.includes(p.Y3B.CpuUsage)&&(0,s.jsx)(ee.BillItemInfo,{text:"CPU usage",value:h.cpuPercentvCPU*Z.PRICE_MINUTELY_VCPU}),n.includes(p.Y3B.MemoryUsage)&&(0,s.jsx)(ee.BillItemInfo,{text:"Memory usage",value:h.memoryUsageGB*Z.PRICE_MINUTELY_MEM_GB}),n.includes(p.Y3B.NetworkUsage)&&(0,s.jsx)(ee.BillItemInfo,{text:"Network usage",value:h.egressGB*Z.PRICE_EGRESS_GB}),n.includes(p.Y3B.DiskUsage)&&(0,s.jsx)(ee.BillItemInfo,{text:"Volume usage",value:h.diskGB*Z.PRICE_MINUTELY_DISK_GB}),n.includes(p.Y3B.BackupUsage)&&h.backupGB>0&&(0,s.jsx)(ee.BillItemInfo,{text:"Backup usage",value:h.backupGB*Z.PRICE_MINUTELY_BACKUP_GB})]})};r(50253),r(24224),r(64963),r(3732);var es=r(67366),ea=r(81428),el=r(23466),en=r(90511),ei=r(97989),eo=r(29009),ed=r(47829),ec=r(40853),eu=r(77146),em=r(49872),eh=r(25836),ex=r(60904);let eg=e=>(0,s.jsx)(ep,{...e});function ep(e){let{environmentId:t,projectId:r,logsFilter:a}=e,[l,n]=(0,i.useState)(!1),[o]=(0,d.f$)(),c=(0,i.useMemo)(()=>({startTime:new Date(o.getStartDate()).getTime(),endTime:o.getEndDate?new Date(o.getEndDate()).getTime():null}),[o]),u=(0,i.useRef)(null),m=(0,ex.EM)({variables:{environmentId:t,filter:a,...(0,ea.m)({timeRange:c})},mode:"stream",streamPaused:l,onStreamPausedChange:n}),h=(0,ex.KX)(m),x=(0,el.FW)({id:r,type:"deploy"}),g=(0,i.useCallback)(function(e,t){var r;let a=null==(r=m.store.get(ex.uc))?void 0:r.has(e.timestamp);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(en.x,{severity:e.severity,showSeverity:x.showSeverity,isNew:a,className:"select-none",children:e.timestamp}),(0,s.jsx)(eo.n,{data:e,severity:e.severity,wrapText:x.wrapText,showPlainText:x.showPlainText,isNew:a,dataColumns:x.dataColumns,showAttributes:x.showDataAttributes,toJSON:ev}),!x.showRawData&&(0,s.jsx)(ei.n,{severity:e.severity,isNew:a})]})},[x,m.store]),p=(0,i.useCallback)(()=>{let e=[{key:"time",columnKey:"timestamp",defaultWidth:120,children:"Time"},{key:"data",columnKey:"data",children:"Data"},{key:"settings",columnKey:"settings",defaultWidth:64,children:(0,s.jsx)(el.QA,{id:r,type:"deploy",className:"!pr-0",visibleOptions:{dataColumns:!1,railwayColumns:!1,showRawData:!1,showHistogram:!1}}),className:"text-right"}];return e.map((t,r)=>(0,s.jsx)(ed.x,{columnKey:t.columnKey,resizable:r<e.length-(x.showRawData?2:1),defaultWidth:t.defaultWidth,className:t.className,style:t.style,children:t.children},t.key))},[x]);return(0,i.useEffect)(()=>{if("connected"!==m.status&&"connecting"!==m.status&&!l){var e;null==(e=u.current)||e.scrollToPosition("bottom")}},[m.status]),(0,s.jsxs)("div",{className:"absolute inset-0 grid grid-rows-[minmax(0,auto),max-content] w-full rounded-md overflow-hidden border border-neutral",children:[(0,s.jsxs)("div",{className:"w-full h-full relative max-w-[100vw] bg-background",children:[m.isLoading&&!m.data.length?(0,s.jsx)(eh.C,{}):m.isLoading||m.data.length?(0,s.jsx)(ec.t,{logs:m.data,toJSON:ex.H_,children:(0,s.jsx)(es.M,{ref:u,data:m.data,showScrollbar:!1,renderRow:g,renderHeader:p,renderTopBookend:e=>(0,s.jsx)(eu.w,{position:"top",timeRange:c,pagination:h,...e}),renderBottomBookend:e=>(0,s.jsx)(eu.w,{position:"bottom",timeRange:c,pagination:h,...e}),onScrollStateChange:e=>{"bottom"!==e.position&&"both"!==e.position?n(!0):n(!1)}})}):(0,s.jsx)(eh.C,{title:"No logs found for this filter",subtitle:"Logs will show up here as they are found."}),(0,s.jsx)(em.Y,{isPaused:"timedOut"===m.status,onResume:()=>{n(!1),m.reconnectStream()}})]}),(0,s.jsx)("div",{className:"flex bg-secondaryBg w-full flex-col p-2 gap-y-3.5 border-t border-t-neutral max-w-[100vw]",children:(0,s.jsx)(eb,{timeRange:c,filter:a})})]})}let ev=e=>(0,ex.H_)(e,{message:!0,timestamp:!0,attributes:!0,tags:!1});function eb(e){let{filter:t,timeRange:r}=e,{routes:a}=(0,A.c)();return(0,s.jsx)(h.vx,{iconRight:u.GrD,color:"gray",size:"xs",variant:"outline",className:"p-4 bg-background",title:"Open in Log Explorer",...a.projectLogs({filter:t,start:r.startTime+"",end:r.endTime?r.endTime+"":void 0}),children:"Open in Log Explorer"})}var ef=r(36609),ej=r(14034),ey=r(5979),ew=r(72898),ek=r(77505),eN=r(88887),eI=r(66800),eC=r.n(eI);function eS(e){let{environmentId:t}=e,[r]=(0,d.f$)(),{graphqlClient:a}=(0,y.q)(),{modalActions:l}=(0,ek.U)(),n=["observabilityDashboards",t,{timeRangeKey:r.display}],{result:i}=(0,j.W)(n,async()=>{var e,s;let l=r.getStartDate(),n=null!=(s=null==(e=r.getEndDate)?void 0:e.call(r))?s:null,i=await a.observabilityDashboards({environmentId:t,alertStartDate:l,alertEndDate:n});return(0,ey.nX)(i).observabilityDashboards},{staleTime:eC()("5s")}),o={observabilityDashboardUpdate:(0,ew.n)(n,async e=>(await a.observabilityDashboardUpdate(e)).observabilityDashboardUpdate),observabilityDashboardCreate:(0,ew.n)(n,async e=>(await a.observabilityDashboardCreate(e)).observabilityDashboardCreate),observabilityDashboardReset:(0,ew.n)(n,async e=>(await a.observabilityDashboardReset(e)).observabilityDashboardReset),saveDashboard:(0,ew.n)(n,async e=>{var r,a;let{config:n,showSuccessToast:d=!0}=e;if(null==i.data||0===i.data.length){try{await o.observabilityDashboardCreate({input:{environmentId:t,items:n.items.map(e=>({id:e.id,displayConfig:e.displayConfig,dashboardItem:{id:e.dashboardItem.id,name:e.dashboardItem.name,description:e.dashboardItem.description,type:e.dashboardItem.type,config:e.dashboardItem.config}}))}}),d&&l.createToast((0,s.jsx)(eN.y8,{variant:"success",title:"Success",description:"Observability dashboard created."}))}catch(e){l.createToast((0,s.jsx)(eN.y8,{variant:"error",title:"Error",description:null!=(r=e.message)?r:"Unable to create observability dashboard."}))}return}try{let e=i.data[0];await o.observabilityDashboardUpdate({id:e.id,input:n.items.map(e=>({id:e.id,displayConfig:e.displayConfig,dashboardItem:{id:e.dashboardItem.id,name:e.dashboardItem.name,description:e.dashboardItem.description,type:e.dashboardItem.type,config:e.dashboardItem.config}}))}),d&&l.createToast((0,s.jsx)(eN.y8,{variant:"success",title:"Success",description:"Observability dashboard updated."}))}catch(e){throw l.createToast((0,s.jsx)(eN.y8,{variant:"error",title:"Error",description:null!=(a=e.message)?a:"Unable to update observability dashboard."})),e}}),createMonitor:(0,ew.n)(n,async e=>{try{let t=(await a.observabilityDashboardMonitorCreate(e)).observabilityDashboardMonitorCreate;return l.createToast((0,s.jsx)(eN.y8,{variant:"success",title:"Success",description:"Observability monitor created."})),t}catch(e){var t;throw l.createToast((0,s.jsx)(eN.y8,{variant:"error",title:"Error",description:null!=(t=e.message)?t:"Unable to create observability monitor."})),e}}),updateMonitor:(0,ew.n)(n,async e=>{try{let t=(await a.observabilityDashboardMonitorUpdate(e)).observabilityDashboardMonitorUpdate;return l.createToast((0,s.jsx)(eN.y8,{variant:"success",title:"Success",description:"Observability monitor updated."})),t}catch(e){var t;throw l.createToast((0,s.jsx)(eN.y8,{variant:"error",title:"Error",description:null!=(t=e.message)?t:"Unable to update observability monitor."})),e}}),removeMonitor:(0,ew.n)(n,async e=>{try{let t=(await a.observabilityDashboardMonitorRemove(e)).observabilityDashboardMonitorRemove;return l.createToast((0,s.jsx)(eN.y8,{variant:"success",title:"Success",description:"Observability monitor removed."})),t}catch(e){var t;throw l.createToast((0,s.jsx)(eN.y8,{variant:"error",title:"Error",description:null!=(t=e.message)?t:"Unable to remove observability monitor."})),e}})};return{dashboards:i,actions:o}}var eM=r(41220),eT=r(80430),ez=r(88486),eD=r(73648),eU=r(59459);let eE="text-neutral focus:text-neutral dark:focus:text-neutral focus:bg-neutral-surface-hover font-medium text-sm rounded",eR=e=>{let{id:t,environmentId:r,hasMonitor:l,onSelectMonitor:o}=e,[d,m]=(0,a.fp)(eK),{actions:x}=eS({environmentId:r}),g=(0,i.useMemo)(()=>d.items.find(e=>e.id===t),[t,d.items]),{isPro:v}=(0,eD.hA)(),b=(0,i.useMemo)(()=>{var e;if(null==g)return null;if(g.dashboardItem.type===p.xW4.ProjectUsageItem)return"ProjectUsage";if(g.dashboardItem.type===p.xW4.ServiceLogsItem)return"Logs";let t=null!=(e=g.dashboardItem.config.measurements)?e:[];return U()(t,e5.Cpu.measurements)?"Cpu":U()(t,e5.Memory.measurements)?"Memory":U()(t,e5.Network.measurements)?"Network":U()(t,e5.Disk.measurements)?"Disk":null},[g]),{showModal:f}=(0,c.h)();if(null==g||null==b)return null;let j=g.dashboardItem.type===p.xW4.ServiceMetricsItem||g.dashboardItem.type===p.xW4.VolumeMetricsItem;return(0,s.jsxs)(R.ms,{children:[(0,s.jsx)(ej.ty,{asChild:!0,children:(0,s.jsx)(h.K0,{icon:u.GvN,color:"gray",size:"sm",variant:"ghost",title:"Options",className:"shrink-0"})}),(0,s.jsxs)(R.pm,{align:"start",className:"min-w-0 p-1",onCloseAutoFocus:e=>e.preventDefault(),children:[(0,s.jsx)(R.tJ,{className:eE,onSelect:()=>{var e,t,s,a;return f(e6,{environmentId:r,existingItem:{formValues:{name:g.dashboardItem.name,description:null!=(e=g.dashboardItem.description)?e:void 0,type:b,resourceIds:null!=(t=g.dashboardItem.config.resourceIds)?t:[],projectUsageProperties:null!=(s=g.dashboardItem.config.projectUsageProperties)?s:[],logsFilter:null!=(a=g.dashboardItem.config.logsFilter)?a:""},displayConfig:g.displayConfig,id:g.id,dashboardItemId:g.dashboardItem.id}})},children:(0,s.jsxs)(n.z,{space:2,align:"center",children:[(0,s.jsx)(P.In,{icon:u.Pt,size:"sm",className:"text-neutral-secondary"}),(0,s.jsx)(T.ax,{children:"Edit"})]})}),j&&v&&(0,s.jsx)(R.tJ,{className:eE,onSelect:o,children:(0,s.jsxs)(n.z,{space:2,align:"center",children:[(0,s.jsx)(P.In,{icon:u.IrQ,size:"sm",className:"text-neutral-secondary"}),(0,s.jsxs)(T.ax,{children:[l?"Edit":"Add"," Monitor"]})]})}),(0,s.jsx)(R.tJ,{className:"text-danger font-medium dark:focus:text-danger focus:text-danger focus:bg-danger-surface-hover rounded",onSelect:()=>{let e={...d,items:d.items.filter(e=>e.id!==t)};x.saveDashboard({config:e,showSuccessToast:!0}),m(e)},children:(0,s.jsxs)(n.z,{space:2,align:"center",children:[(0,s.jsx)(P.In,{icon:u.lMJ,size:"sm",className:"text-danger-secondary"}),(0,s.jsx)(T.ax,{children:"Delete"})]})})]})]})},eP=e=>{var t,r,a,l;let{id:o,height:d,projectId:c,environmentId:m,dashboardItem:h,monitors:x,isPreview:g=!1,isResizing:v=!1,isEditable:b=!1}=e,f=(0,i.useRef)(null),[j,y]=(0,i.useState)({open:!1}),w=(0,i.useMemo)(()=>d-16-2-32-1-24,[d]),{config:k,name:N,description:I,type:C}=h,S=null==x?void 0:x.some(e=>e.alerts.some(e=>e.status===p.Lsm.Alert)),M=(0,eU.y)(f),{query:z}=(0,A.c)(),D=z.monitorId,U=null==x?void 0:x.find(e=>e.id===D);return(0,i.useEffect)(()=>{if(!U)return;let e=setTimeout(()=>{var e;null==(e=f.current)||e.scrollIntoView({block:"center",inline:"center",behavior:"smooth"})},1e3);return()=>clearTimeout(e)},[U]),(0,s.jsxs)(eM.AM,{open:j.open,onOpenChange:e=>y(t=>({...t,open:e})),children:[(0,s.jsx)("div",{ref:f,className:(0,ef.xW)("@container bg-background border border-neutral rounded-lg p-4 relative w-full h-full transition-colors",S&&"border-red-500",(j.open||U&&!S)&&"border-pink-500"),children:(0,s.jsxs)(n.T,{className:"h-full",space:5,children:[(0,s.jsxs)("div",{className:"max-h-6 h-full grid grid-cols-[minmax(0,1fr)_auto] grid-rows-[max-content,minmax(0,auto)] items-start gap-2 group",children:[(0,s.jsxs)(n.T,{className:"relative w-full max-w-full",children:[(0,s.jsx)(T.TT,{className:(0,ef.xW)("truncate",I&&!g&&"transition ease-in-out translate-y-0 group-hover:-translate-y-1"),children:N}),(0,s.jsx)(T.tj,{className:(0,ef.xW)("text-gray-500 truncate",!g&&"hidden",I&&!g&&"group-hover:block transition ease-in-out translate-y-0 group-hover:-translate-y-1"),title:null!=I?I:void 0,children:I})]}),(0,s.jsxs)(n.z,{align:"center",space:2,children:[(0,s.jsx)(P.In,{icon:u.yUV,size:"sm",className:(0,ef.xW)("drag-handle cursor-move text-gray-300 select-none group-hover:visible invisible",(!b||g)&&"!hidden")}),!g&&(0,s.jsx)(eR,{id:o,environmentId:m,hasMonitor:!!(null==x?void 0:x.length),onSelectMonitor:()=>y(e=>({...e,open:!0}))})]})]}),(0,s.jsx)("div",{className:"h-full overflow-y-auto relative",children:C===p.xW4.ProjectUsageItem?(0,s.jsx)(er,{projectId:c,projectUsageProperties:null!=(t=k.projectUsageProperties)?t:[]}):C===p.xW4.ServiceLogsItem?(0,s.jsx)(eg,{environmentId:m,projectId:c,logsFilter:null!=(r=k.logsFilter)?r:""}):(0,s.jsx)($,{type:C,height:w,environmentId:m,resourceIds:null!=(a=k.resourceIds)?a:[],measurements:null!=(l=k.measurements)?l:[],isResizing:!g&&v,monitors:x})}),(0,s.jsx)(eM.dT,{className:(0,ef.xW)("absolute inset-y-0 right-0 pointer-events-none",M?M.x<376?"right-0":"left-0":"")})]})}),(0,s.jsx)(eW,{environmentId:m,dashboardItem:h,monitor:null==x?void 0:x[0],onClose:()=>y({open:!1})})]})};function eW(e){var t,r,a,l;let{environmentId:n,dashboardItem:i,monitor:o,onClose:d}=e,{register:c,setValue:u,handleSubmit:m,formState:g}=(0,x.mN)({defaultValues:{condition:null!=(a=null==o?void 0:o.config.condition)?a:p.deD.Above,threshold:null!=(l=null==o?void 0:o.config.threshold)?l:0},resolver:(0,ez.u)(e_)}),{actions:v}=eS({environmentId:n}),{isConfirmed:b}=(0,W.S)(),f=null==(t=i.config.measurements)?void 0:t[0];return(0,s.jsx)(eM.i0,{children:(0,s.jsxs)(eM.hl,{side:"right",align:"center",sideOffset:0,className:"bg-background z-10 p-6 focus:outline-none rounded-lg border border-neutral-light dark:border-neutral w-[376px] max-w-[90vw] sm:w-[376px] text-sm shadow-[0px_0_0_1px_rgba(0,0,0,0.06),0px_1px_2px_-0.5px_rgba(0,0,0,0.06),0px_6px_12px_-3px_rgba(0,0,0,0.06),0px_16px_32px_-8px_rgba(0,0,0,0.06)]",hideWhenDetached:!0,children:[(0,s.jsx)(eM.Rp,{width:16,height:8,className:"fill-background popover-arrow-shadow stroke-1 stroke-gray-100 dark:stroke-gray-200"}),(0,s.jsxs)("form",{className:"flex flex-col gap-3.5",onSubmit:m(async e=>{let{condition:t,threshold:r}=e;o?await v.updateMonitor({id:o.id,input:{config:{type:p.hcg.Threshold,threshold:{condition:t,threshold:r}}}}):await v.createMonitor({dashboardItemId:i.id,input:{config:{type:p.hcg.Threshold,threshold:{condition:t,threshold:r}}}}),null==d||d()}),children:[(0,s.jsxs)(T.mM,{className:"flex items-center gap-2",children:[(0,s.jsxs)("div",{children:[o?"Edit":"Add"," monitor"]}),(0,s.jsx)("div",{className:"rounded-full bg-primary-surface text-primary text-xs font-medium px-2 py-px",children:"Beta"})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsxs)("span",{className:"font-medium",children:["Trigger alert when ",function(e){let{measurement:t}=e;switch(t){case p.zc2.MemoryUsageGb:return"memory usage";case p.zc2.NetworkTxGb:return"network egress";case p.zc2.NetworkRxGb:return"network ingress";case p.zc2.DiskUsageGb:return"disk usage";case p.zc2.BackupUsageGb:return"backup usage";case p.zc2.CpuUsage:return"CPU"}}({measurement:f})," is..."]}),(0,s.jsxs)("div",{className:"grid grid-cols-[33%,auto] gap-2",children:[(0,s.jsx)(eT.l,{label:{text:"Threshold Operator",hidden:!0},options:[{value:"above",text:"Above"},{value:"below",text:"Below"}],size:"md",defaultValue:null==(r=g.defaultValues)?void 0:r.condition,onChange:e=>{u("condition",e)}}),(0,s.jsx)(S.pd,{label:{text:"Threshold Value",hidden:!0},placeholder:"1",size:"md",type:"number",step:"any",suffix:(0,s.jsx)("span",{className:"text-xs text-neutral-secondary",children:function(e){let{measurement:t}=e;switch(t){case p.zc2.MemoryUsageGb:case p.zc2.NetworkTxGb:case p.zc2.NetworkRxGb:case p.zc2.DiskUsageGb:case p.zc2.BackupUsageGb:return"GB";case p.zc2.CpuUsage:return"vCPU"}}({measurement:f})}),...c("threshold",{required:!0,min:0})})]})]}),(0,s.jsx)("div",{className:"flex flex-col gap-[0.75em] text-neutral-secondary",children:(0,s.jsx)("p",{children:"Youâ€™ll get an email when this monitor is triggered."})}),(0,s.jsxs)("div",{className:"flex gap-2 pt-3",children:[(0,s.jsxs)(h.$n,{size:"sm",className:"font-medium",type:"submit",isLoading:g.isSubmitting,children:[o?"Update":"Create"," monitor"]}),!g.isSubmitting&&!o&&(0,s.jsx)(h.$n,{size:"sm",color:"gray",variant:"outline",className:"border-neutral font-medium",onClick:d,type:"button",children:"Cancel"}),o&&(0,s.jsx)(h.$n,{size:"sm",color:"red",variant:"outline",className:" font-medium",type:"button",onClick:async()=>{o.id&&await b({confirmLabel:"Delete",message:"Are you sure you want to delete this monitor?",title:"Delete monitor"})&&(await v.removeMonitor({id:o.id}),null==d||d())},children:"Delete"})]})]})]})})}let e_=E.z.object({condition:E.z.nativeEnum(p.deD),threshold:E.z.preprocess(e=>Number(e),E.z.number().min(0))});var eB=r(24554),eA=r(43384),eF=r.n(eA),eL=r(54523),eV=r(49873);let eO=e=>parseInt((0,eV.createHash)("md5").update(e).digest("hex").slice(0,8),16),eG=e=>{let{color:t,map:r}=e;for(let e of r.values())if(e===t)return!0;return!1},eY={maxW:12,minW:3,minH:2},eH={breakpoints:{lg:{width:1024,cols:12,limits:{...eY}},md:{width:768,cols:4,limits:{...eY,maxW:6}},xxs:{width:0,cols:4,limits:{...eY,maxW:4}}},gridRowHeight:150,margin:16},eK=(0,eB.eU)({items:[],resourceColorMap:new Map}),eq=e=>{let{environmentId:t}=e,{dashboards:r,actions:a}=eS({environmentId:t}),[l,o]=(0,i.useState)(!1),{modalActions:d}=(0,ek.U)(),{showModal:u}=(0,c.h)(),m=(0,eL.a)({lightImage:"/illustrations/observability/empty-state--light.svg",darkImage:"/illustrations/observability/empty-state--dark.svg"}),x=async()=>{o(!0);let e=null!=r.data&&0!==r.data.length?r.data[0].id:null;try{null==e?await a.observabilityDashboardCreate({input:{environmentId:t}}):await a.observabilityDashboardReset({id:e}),d.createToast((0,s.jsx)(eN.y8,{variant:"success",title:"Success",description:"Observability dashboard created."}))}catch(e){var l;d.createToast((0,s.jsx)(eN.y8,{variant:"error",title:"Error",description:null!=(l=e.message)?l:"Unable to create default dashboard."}))}o(!1)};return(0,s.jsxs)(n.T,{center:!0,space:6,className:"rounded-lg border border-dashed border-gray-200 w-full h-[75vh]",children:[(0,s.jsx)(eF(),{alt:"",src:m,width:200,height:170}),(0,s.jsxs)(n.T,{space:1,center:!0,className:"max-w-sm text-center",children:[(0,s.jsx)(T.mM,{children:"Observe this environment"}),(0,s.jsx)(T.xC,{children:"Monitor project usage, resource metrics and custom log dashboards."})]}),(0,s.jsxs)(n.T,{space:2,className:"max-w-sm w-full",children:[(0,s.jsx)(h.$n,{type:"button",variant:"outline",color:"gray",onClick:()=>{u(e6,{environmentId:t})},disabled:l,children:"Add new item"}),(0,s.jsx)(h.$n,{type:"button",name:"Start with a simple dashboard",isLoading:l,disabled:l,onClick:x,children:"Start with a simple dashboard"})]})]})},eJ=i.forwardRef((e,t)=>{let{handleAxis:r,isEditable:a,...l}=e;return(0,s.jsx)(P.In,{...l,ref:t,className:(0,ef.xW)("handle-".concat(r," react-resizable-handle invisible group-hover:visible select-none"),"absolute bottom-0 right-0 cursor-se-resize","text-gray-300",a&&"!flex"),size:"sm",icon:u.rlm})}),e$=e=>{let{environmentId:t,projectId:r}=e,{width:l}=(0,N.l)(),[o,d]=(0,i.useState)(null),[c,u]=(0,a.fp)(eK),{dashboards:m,actions:h}=eS({environmentId:t}),{services:x,volumes:g}=k();(0,i.useEffect)(()=>{if(null==m.data)return;let e=(e=>{let t=new Map;for(let r of e){let e=eO(r)%G.tM.length,s=G.tM[e];if(t.size>=G.tM.length){t.set(r,s);continue}let a=0;for(;eG({color:s,map:t});)a++,s=G.tM[(e+a)%G.tM.length];t.set(r,s)}return t})([...x.map(e=>e.id),...g.map(e=>e.id)]);u(t=>({...t,resourceColorMap:e,items:0===m.data.length?[]:m.data[0].items}))},[m.data,x.length,g.length]);let p=(0,i.useMemo)(()=>{let e=[],t=[],r=[],s=0;for(let a of c.items)e.push({...a.displayConfig,...eH.breakpoints.lg.limits,i:a.id}),t.push({...a.displayConfig,...eH.breakpoints.md.limits,i:a.id,y:s}),r.push({...a.displayConfig,...eH.breakpoints.xxs.limits,i:a.id,y:s}),s+=a.displayConfig.h;return{lg:e,md:t,xxs:r}},[c.items]),v=l-65>=eH.breakpoints.lg.width,b=(e,t,r)=>{let s=t.i,a=c.items.find(e=>e.id===s);if(null==a)return;let l={...a,displayConfig:{...a.displayConfig,h:r.h,w:r.w,x:r.x,y:r.y}},n={...c,items:c.items.map(e=>e.id===s?l:e)};u(n),h.saveDashboard({config:n,showSuccessToast:!1}),d(null)},f=(0,i.useMemo)(()=>c.items.map(e=>{var a,l,n;return(0,s.jsx)("div",{className:"group",children:(0,s.jsx)(eP,{id:e.id,dashboardItem:e.dashboardItem,height:e.displayConfig.h*eH.gridRowHeight+eH.margin*(e.displayConfig.h-1)-16,monitors:null==(n=m.data)||null==(l=n[0])||null==(a=l.items.find(t=>t.id===e.id))?void 0:a.dashboardItem.monitors,environmentId:t,projectId:r,isResizing:o===e.id,isEditable:v})},e.id)}),[c.items,m.data,o,t,r,v]);return m.isLoading?(0,s.jsx)(n.T,{center:!0,className:"w-full h-full",children:(0,s.jsx)(Y.t,{})}):m.isError?(0,s.jsx)(n.T,{center:!0,className:"w-full h-full",children:(0,s.jsx)(T.yn,{children:"Oops, there was an error loading the observability dashboard."})}):0===p.lg.length?(0,s.jsx)(n.T,{center:!0,className:"w-full h-full",children:(0,s.jsx)(eq,{environmentId:t})}):(0,s.jsx)(z.Responsive,{breakpoints:{lg:eH.breakpoints.lg.width,md:eH.breakpoints.md.width,xxs:eH.breakpoints.xxs.width},cols:{lg:eH.breakpoints.lg.cols,md:eH.breakpoints.md.cols,xxs:eH.breakpoints.xxs.cols},layouts:p,rowHeight:eH.gridRowHeight,margin:[eH.margin,eH.margin],width:l-48,onResizeStart:(e,t)=>d(t.i),onResizeStop:b,onDragStop:b,resizeHandle:(0,s.jsx)(eJ,{isEditable:v}),isDraggable:v,isResizable:v,draggableHandle:".drag-handle",children:f})};var eQ=r(71252),eX=r(83271),eZ=r(79006);let e0=e=>Array.isArray(e),e1=e=>{let{options:t,onChange:r,value:a,placeholder:l,customStyles:i,iconSize:o,isMulti:d=!1,isSearchable:c=!1}=e,{colorMode:m}=(0,eZ.DP)();return(0,s.jsx)(eQ.Ay,{options:t,onChange:r,placeholder:l,isMulti:d,closeMenuOnSelect:!d,isSearchable:c,value:a,styles:{control:(e,t)=>{var r;return{...e,backgroundColor:"var(--background)",borderColor:"var(--gray-200)",borderRadius:"6px",minHeight:"42px",boxShadow:"none",cursor:"pointer",":hover":{borderColor:"var(--gray-400)"},":focus":{border:"1px solid var(--pink-400)"},...null==i||null==(r=i.control)?void 0:r.call(i,e,t)}},valueContainer:e=>({...e,paddingLeft:"16px"}),singleValue:(e,t)=>{var r;return{...e,color:"var(--foreground)",...null==i||null==(r=i.singleValue)?void 0:r.call(i,e,t)}},indicatorsContainer:e=>({...e,paddingRight:"16px"}),indicatorSeparator:()=>({display:"none"}),dropdownIndicator:e=>({...e,padding:0,color:"var(--gray-500)"}),input:e=>({...e,color:"var(--foreground)"}),menu:e=>({...e,backgroundColor:"dark"===m?"var(--gray-100)":"white",borderRadius:"8px",zIndex:11}),menuList:e=>({...e,borderRadius:"8px"}),option:(e,t)=>({...e,backgroundColor:t.isSelected?"var(--secondaryBg)":"transparent",color:"var(--foreground)",padding:"16px",cursor:"pointer",":hover":{backgroundColor:"var(--secondaryBg)"}}),multiValue:e=>({...e,backgroundColor:"var(--gray-100)",borderRadius:"4px"}),multiValueRemove:e=>({...e,color:"var(--gray-300)",":hover":{backgroundColor:"var(--gray-200)"}})},components:{SingleValue:e=>{let[t]=e.getValue();return(0,s.jsx)(eX.c.SingleValue,{...e,children:(0,s.jsxs)(n.z,{align:"center",space:2,children:[null!=t.icon&&(0,s.jsx)(P.In,{size:o,icon:"string"==typeof t.icon?()=>(0,s.jsx)(u.xfq,{src:t.icon}):t.icon,className:"text-gray-500"}),(0,s.jsx)("p",{children:t.label})]})})},MultiValue:e=>(0,s.jsx)(eX.c.MultiValue,{...e,children:(0,s.jsxs)(n.z,{children:[null!=e.data.prefixMultiValue&&(0,s.jsx)(T.ax,{className:"font-mono text-blue-600",children:e.data.prefixMultiValue}),(0,s.jsx)(T.ax,{className:"text-foreground",children:e.data.label})]})}),Option:e=>(0,s.jsx)(eX.c.Option,{...e,children:(0,s.jsxs)(n.z,{align:"center",space:2,children:[null!=e.data.icon&&(0,s.jsx)(P.In,{icon:"string"==typeof e.data.icon?()=>(0,s.jsx)(u.xfq,{src:e.data.icon}):e.data.icon,className:"text-gray-500"}),(0,s.jsx)(T.EY,{children:e.data.label})]})})}})},e2={height:786,width:1080},e5={Cpu:{text:"CPU Usage",icon:u.fX,value:p.xW4.ServiceMetricsItem,measurements:[p.zc2.CpuUsage]},Memory:{text:"Memory Usage",icon:u.UMG,value:p.xW4.ServiceMetricsItem,measurements:[p.zc2.MemoryUsageGb]},Network:{text:"Network Egress",icon:u.lgv,value:p.xW4.ServiceMetricsItem,measurements:[p.zc2.NetworkTxGb]},Disk:{text:"Disk Usage",icon:u.akk,value:p.xW4.VolumeMetricsItem,measurements:[p.zc2.DiskUsageGb]},Logs:{text:"Logs",icon:u.vji,value:p.xW4.ServiceLogsItem},ProjectUsage:{text:"Project Usage",icon:u.G9t,value:p.xW4.ProjectUsageItem,projectUsageProperties:[p.Y3B.CurrentUsage,p.Y3B.EstimatedUsage,p.Y3B.CpuUsage,p.Y3B.MemoryUsage,p.Y3B.NetworkUsage,p.Y3B.DiskUsage]}},e4=Object.values(e5).map(e=>e.text),e3={name:e5.Cpu.text,description:"",type:"Cpu",logsFilter:"",resourceIds:[],projectUsageProperties:[]},e6=e=>{var t,r,l,o,d;let{open:c,onOpenChange:v,environmentId:b,existingItem:f}=e,j=(0,a.md)(m.Zy),y=(0,i.useRef)(null),{height:z,width:D}=(0,N.l)(),{height:U,width:E}=(0,i.useMemo)(()=>({height:.8*z>e2.height?e2.height:.8*z,width:.8*D>e2.width?e2.width:.8*D}),[z,D]),[R,P]=(0,i.useState)(!1),[W,_]=(0,a.fp)(eK),{actions:B}=eS({environmentId:b}),A={...e3,...null==f?void 0:f.formValues},{control:F,handleSubmit:L,formState:{errors:V},register:O,setValue:G,watch:Y,reset:H}=(0,x.mN)({defaultValues:A});(0,i.useEffect)(()=>{c&&null!=f&&(H(f.formValues),P(null!=f.formValues.description))},[c,f]);let K=()=>{H(e3),P(!1),v(!1)},{services:q,volumes:J}=k(),$=Y("type"),Q=Y("resourceIds"),X=Y("name"),Z=Y("description"),ee=Y("projectUsageProperties"),et=Y("logsFilter"),er=e=>{if(null==e)return;let t=e0(e)?e[0].value:e.value;G("type",t),G("resourceIds",[]),(""===X||e4.includes(X))&&G("name",e5[t].text)};return(0,s.jsx)(M.a.Root,{open:c,onOpenChange:K,hasFullBleedContent:!0,children:(0,s.jsx)("div",{ref:y,className:"relative flex",style:{height:U,width:E},children:(0,s.jsx)(C.lV,{className:"flex flex-col h-full w-full",onSubmit:L(e=>{var t,r,s,a,l;let n,i=e5[e.type].value,o={id:null!=(t=null==f?void 0:f.dashboardItemId)?t:(0,g.A)(),name:e.name.trim(),description:null==e.description||""===e.description.trim()?null:e.description};if(i===p.xW4.ServiceMetricsItem||i===p.xW4.VolumeMetricsItem){let t=null!=(r=e5[e.type].measurements)?r:[];n={type:i,config:{resourceIds:e.resourceIds,measurements:t}}}else if(i===p.xW4.ServiceLogsItem)n={type:i,config:{logsFilter:e.logsFilter}};else{let t=0===e.projectUsageProperties.length?null!=(s=e5.ProjectUsage.projectUsageProperties)?s:[]:e.projectUsageProperties;n={type:p.xW4.ProjectUsageItem,config:{projectUsageProperties:t}}}if(null==n)return;let d={id:null!=(a=null==f?void 0:f.id)?a:(0,g.A)(),displayConfig:w,dashboardItem:{...o,...n}},c=null!=(l=W.items)?l:[];if(null==f){let e=[d,...W.items],t={...W,items:e};return B.saveDashboard({config:t}),_(t),K()}let u=c.map(e=>e.id===f.id?{...d,displayConfig:f.displayConfig}:e),m={...W,items:u};B.saveDashboard({config:m}),_(m),K()}),children:(0,s.jsxs)(n.T,{space:10,className:"h-full mx-12 my-2 overflow-y-auto",children:[(0,s.jsx)(T.mM,{children:"New Item"}),(0,s.jsxs)(n.T,{space:6,children:[(0,s.jsxs)(n.z,{children:[(0,s.jsx)("div",{className:"min-w-xs",children:(0,s.jsx)(x.xI,{name:"type",control:F,render:e=>{let{field:{value:t}}=e,r=Object.entries(e5).map(e=>{let[t,{text:r,icon:s}]=e;return{label:r,value:t,icon:s}});return 0===J.length&&(r=r.filter(e=>"Disk"!==e.value)),(0,s.jsx)(e1,{placeholder:"What would you like to monitor",options:r,onChange:er,value:{label:e5[t].text,value:t,icon:e5[t].icon},customStyles:{control:()=>({borderTopRightRadius:0,borderBottomRightRadius:0})}})}})}),(0,s.jsx)("div",{className:"flex-1",children:"Logs"===$?(0,s.jsx)(x.xI,{name:"logsFilter",control:F,render:e=>{let{field:{onChange:t}}=e;return(0,s.jsx)(I.j,{autoFocus:!0,label:{text:"Logs filter",hidden:!0},placeholder:'Filter logs using "", (), AND, OR, -',hint:"Use @service:serviceId to filter by service and @level:level to filter by log level",onChange:t,options:[...q.map(e=>({icon:"string"==typeof e.icon?()=>(0,s.jsx)(u.xfq,{src:e.icon}):e.icon,value:"@service:".concat(e.id),hint:e.name,numMatchStart:1})),{value:"@level:debug",icon:u.dJT},{value:"@level:info",icon:u.dJT},{value:"@level:warn",icon:u.dJT},{value:"@level:error",icon:u.dJT}],value:et,icon:u.yQN,iconContainerClassName:"mt-2 mr-2",portalContainer:null==y.current?void 0:y.current,className:"rounded-tl-none rounded-bl-none"})}}):"ProjectUsage"===$?(0,s.jsx)(x.xI,{name:"projectUsageProperties",control:F,render:()=>{var e;return(0,s.jsx)(e1,{isMulti:!0,placeholder:"(All stats)",value:ee.map(e=>({label:e.split("_").join(" "),value:e})),options:(null!=(e=e5.ProjectUsage.projectUsageProperties)?e:[]).map(e=>({label:e.split("_").join(" "),value:e})),onChange:e=>{Array.isArray(e)&&G("projectUsageProperties",e.map(e=>e.value))},customStyles:{control:()=>({borderTopLeftRadius:0,borderBottomLeftRadius:0})}})}}):(0,s.jsx)(x.xI,{name:"resourceIds",control:F,render:()=>(0,s.jsx)(e1,{isMulti:!0,isSearchable:!0,placeholder:"Disk"===$?"(All volumes)":"(All services)",options:"Disk"===$?J.map(e=>({label:e.name,value:e.id,icon:u.akk,prefixMultiValue:"@volume:"})):q.map(e=>({label:e.name,value:e.id,icon:e.icon,prefixMultiValue:"@service:"})),value:"Disk"===$?Q.map(e=>{let t=J.find(t=>t.id===e);return null==t?null:{label:t.name,value:e,icon:u.akk,prefixMultiValue:"@volume:"}}).filter(e=>null!=e):Q.map(e=>{let t=q.find(t=>t.id===e);return null==t?null:{label:t.name,value:e,icon:t.icon,prefixMultiValue:"@service:"}}).filter(e=>null!=e),onChange:e=>{Array.isArray(e)&&G("resourceIds",e.map(e=>e.value))},customStyles:{control:()=>({borderTopLeftRadius:0,borderBottomLeftRadius:0})}})})})]}),null!=j&&(0,s.jsx)("div",{style:{height:U/1.75,position:"relative"},children:(0,s.jsx)(eP,{isPreview:!0,id:null!=(l=null==f?void 0:f.id)?l:(0,g.A)(),dashboardItem:{id:null!=(o=null==f?void 0:f.dashboardItemId)?o:(0,g.A)(),name:""===X.trim()?"New Item":X,description:Z,type:e5[$].value,config:{resourceIds:Q,logsFilter:et,measurements:null!=(d=e5[$].measurements)?d:[],projectUsageProperties:0===ee.length?e5.ProjectUsage.projectUsageProperties:ee}},environmentId:j.id,projectId:j.projectId,height:U/2})}),(0,s.jsxs)(n.z,{space:2,children:[(0,s.jsxs)("div",{className:"w-full relative",children:[(0,s.jsx)(S.pd,{...O("name",{required:"Please add a name",minLength:{value:3,message:"Name is too short"}}),label:{text:"Name",hidden:!0},placeholder:"Name",error:null==(t=V.name)?void 0:t.message}),!R&&(0,s.jsx)(h.$n,{type:"button",variant:"ghost",color:"gray",size:"sm",icon:u.FWt,className:"absolute right-0 top-0 mt-1 mr-1 text-gray-300 z-10",onClick:()=>P(!0),children:"Add Description"})]}),R&&(0,s.jsxs)("div",{className:"w-full relative",children:[(0,s.jsx)(S.pd,{...O("description"),label:{text:"Description",hidden:!0},placeholder:"Description",error:null==(r=V.description)?void 0:r.message}),(0,s.jsx)(h.K0,{type:"button",title:"Remove description",icon:u.X,className:"absolute right-0 top-0 mt-1 mr-1 z-10",iconStyles:"text-gray-300",onClick:()=>{G("description",void 0),P(!1)}})]})]}),(0,s.jsx)(h.$n,{type:"submit",disabled:null!=V.name||null!=V.description,children:"Save Item"})]})]})})})})},e7=e=>{let{environmentId:t}=e,[r,a]=(0,d.f$)(),{showModal:l}=(0,c.h)();return(0,s.jsxs)(n.z,{align:"center",justify:"between",className:"pl-10 pr-8 pt-6 pb-2",children:[(0,s.jsx)(e1,{placeholder:"Select a time window",options:d.RE.map(e=>({label:"Last ".concat(e.longDisplay),value:e.display})),value:{label:"Last ".concat(r.longDisplay),value:r.display,icon:u.zD7},onChange:e=>{null!=e&&a(e0(e)?e[0].value:e.value)},iconSize:"sm",customStyles:{control:()=>({minHeight:"34px"}),singleValue:()=>({fontSize:"14px"})}}),(0,s.jsx)(n.z,{align:"center",space:2,children:(0,s.jsx)(h.$n,{icon:u.evX,size:"sm",color:"gray",variant:"outline",className:"bg-background",onClick:()=>l(e6,{environmentId:t,existingItem:void 0}),children:"Add block"})})]})},e9=()=>{let e=(0,a.md)(m.Zy);return null==e?null:(0,s.jsx)(e7,{environmentId:e.id})};var e8=r(99850),te=r(47654),tt=r(65431);let tr=()=>{let e=(0,a.md)(tt.AQ),t=(0,a.md)(m.KE);return null==e||null==t?(0,s.jsx)(l.Rh,{}):(0,s.jsx)(n.T,{className:"px-6 overflow-hidden",children:(0,s.jsx)(e$,{environmentId:t,projectId:e})})},ts=tr;tr.getLayout=e=>{let{children:t}=e,r=(0,i.useRef)(null);return(0,s.jsx)(o.YS,{globalBannerSlotRef:r,seo:{title:"Observability"},children:(0,s.jsxs)("div",{className:"min-h-screen grid grid-rows-[auto_auto_minmax(0,1fr)]",children:[(0,s.jsx)("div",{ref:r}),(0,s.jsx)(e8.g,{}),(0,s.jsxs)("main",{className:"pb-12 bg-secondaryBg dark:bg-background h-full grid grid-rows-[auto_minmax(0px,1fr)] relative",children:[(0,s.jsx)(e9,{}),t,(0,s.jsxs)(n.z,{space:2,align:"center",className:"fixed bottom-0 right-0 mr-4 px-4 py-2 rounded-t-lg border border-gray-200 bg-gray-50 text-sm hover:bg-neutral-surface-hover",children:[(0,s.jsx)(P.In,{icon:u.oFn}),(0,s.jsx)(te.N,{external:!0,href:"https://station.railway.com/feedback/observability-dashboard-51871a24",children:"Provide Feedback"})]})]})]})})}},55802:(e,t,r)=>{"use strict";r.d(t,{u:()=>g});var s=r(50979);r(25963);var a=r(73648),l=r(82660),n=r(95662),i=r(17710),o=r(78920),d=r(43479),c=r(46348),u=r(13620),m=r(82546),h=r(17274),x=r(28531);let g=e=>{let{children:t}=e,{workspaceRole:r}=(0,a.hA)();return(0,s.jsx)(h.n,{children:(0,s.jsxs)(c.N,{children:[(0,s.jsx)(n.T,{space:4,align:"start",className:"w-[240px]",children:(0,s.jsxs)(i.Bx,{className:"pt-0 md:!w-auto",children:[(0,s.jsx)(o.l,{}),(0,s.jsx)(x.S,{}),(0,s.jsx)(d.U,{})]})}),(0,s.jsx)(m.D,{children:(0,s.jsx)(u.F,{children:void 0!==r?t:(0,s.jsx)(p,{})})})]})})},p=()=>(0,s.jsx)("div",{className:"md:mt-20",children:(0,s.jsx)(l.l,{variant:"secondary",centerAlign:!0,children:(0,s.jsxs)("p",{className:"text-center",children:["You donâ€™t have access to this workspace.",(0,s.jsx)("br",{}),"Please contact the workspace owner for access."]})})})},63344:(e,t,r)=>{"use strict";r.d(t,{T:()=>m});var s=r(86739),a=r(50979),l=r(25963),n=r(2551),i=r(36609),o=r(13077),d=r(86954),c=r(95662);function u(){let e=(0,s._)(["\n  rounded-sm whitespace-break-spaces break-words\n  bg-gray-100 dark:bg-gray-200 outline outline-1 outline-[rgba(0,0,0,0.1)] dark:outline-gray-200\n"]);return u=function(){return e},e}let m=l.forwardRef((e,t)=>{var r;let{autoHeight:s,enterToSubmit:u,onSubmit:m,onChange:g,error:p,size:v,name:b,label:f,hint:j,id:y,className:w,contentRight:k,highlights:N=[],textareaSiblings:I,...C}=e,[S,M]=(0,l.useState)(null);(0,l.useImperativeHandle)(t,()=>S);let T="string"==typeof f?f:f.text,z="string"!=typeof f&&f.hidden;y=(0,l.useMemo)(()=>null!=y?y:"textarea-".concat(b)+"-"+Math.random(),[y,b]);let D="".concat(null!=(r=C.value)?r:""),U=(0,l.useMemo)(()=>{if(null==N||0===N.length)return null;N.sort((e,t)=>e.start-t.start);let e=[];for(let r=0;r<N.length;r++){var t;let s=N[r],l=N[r-1];e.push(D.slice(null!=(t=null==l?void 0:l.end)?t:0,s.start)),e.push((0,a.jsx)(x,{children:D.slice(s.start,s.end)},r)),r===N.length-1&&s.end<D.length&&e.push(D.slice(s.end,D.length))}return e},[D,N]),E=(0,i.xW)("flex-grow w-full relative z-10","min-w-0 rounded-md","border border-gray-200 text-foreground bg-transparent","placeholder-gray-500","focus:outline-none",d.kS[null!=v?v:"md"],d.gU[null!=v?v:"md"],p&&"border-red-500 focus:border-red-500",C.disabled&&"text-gray-400 placeholder-gray-400 border-gray-200 bg-gray-100 cursor-not-allowed",!p&&!C.disabled&&"hover:border-gray-400 focus:border-pink-400","overflow-x-hidden",w);return(0,a.jsx)("fieldset",{className:"flex flex-col flex-grow w-full",children:(0,a.jsxs)(c.T,{children:[(0,a.jsxs)(c.z,{align:"center",justify:"between",children:[(0,a.jsx)(d.JU,{htmlFor:y,className:z?"sr-only":"",children:T}),k&&k]}),(0,a.jsxs)("div",{className:"relative flex-grow flex",children:[(null==N?void 0:N.length)>0&&(0,a.jsx)("div",{"aria-hidden":!0,className:(0,i.xW)(E,"absolute z-0 inset-0","select-none pointer-events-none","border border-transparent text-transparent whitespace-break-spaces"),children:U}),(0,a.jsx)("textarea",{ref:e=>{M(e),null!=e&&h(e)},name:b,id:y,rows:1,onChange:e=>{s&&h(e.target),"function"==typeof g&&g(e)},onKeyDown:e=>{u&&"Enter"===e.key&&!e.shiftKey&&(e.stopPropagation(),e.preventDefault(),m&&m())},className:E,...C}),I&&I]}),null!=j&&"string"!=typeof p&&(0,a.jsx)("span",{className:"text-xs font-normal leading-[18px] text-gray-600 block mt-2",children:j}),"string"==typeof p&&(0,a.jsxs)("span",{className:"flex items-center text-red-600 leading-[18px] font-normal text-xs mt-2",children:[(0,a.jsx)(o.In,{icon:n.RIJ,size:"sm",className:"mr-1.5"})," ",p]})]})})}),h=e=>{e.style.height="1rem",e.style.height=e.scrollHeight+2+"px"},x=i.qy.span(u())},78920:(e,t,r)=>{"use strict";r.d(t,{O:()=>M,l:()=>S});var s=r(86739),a=r(50979),l=r(22986),n=r(25963),i=r(70375),o=r(73648),d=r(2551),c=r(52316),u=r(45588),m=r(86337),h=r(36609),x=r(35645),g=r(17057),p=r(13077),v=r(95662),b=r(42419),f=r(17710),j=r(46348),y=r(13620),w=r(82546),k=r(17274),N=r(28531),I=r(43479);function C(){let e=(0,s._)(["flex items-center"]);return C=function(){return e},e}let S=()=>{var e,t;let{routes:r,navActions:s,teamIdQuery:c}=(0,i.c)(),j=(0,l.useRouter)(),[{user:y}]=(0,u.Jd)(),{workspace:w,isPro:k,isHobby:N,isFree:I}=(0,o.hA)(),{setWorkspaceId:C}=(0,m.iS)(),[S,M]=(0,n.useState)(!1),D=(0,n.useMemo)(()=>"/account"===j.route||j.route.startsWith("/account/"),[j.route]);return null==y?null:(0,a.jsx)(f.s2,{children:(0,a.jsxs)(g.ms,{onOpenChange:e=>M(e),children:[(0,a.jsx)(g.uu,{className:(0,h.xW)("border-none hover:bg-gray-100 hover:rounded-md w-56 !h-16 -ml-4 md:-ml-0 select-none",S&&"bg-gray-100 rounded-md"),children:(0,a.jsxs)(v.z,{space:3,align:"center",className:"w-full",children:[(0,a.jsx)(x.e,{avatar:null==w?void 0:w.avatar,name:null==w?void 0:w.name,size:"sm"}),(0,a.jsxs)(v.T,{align:"start",className:"w-32",children:[(0,a.jsx)(b.EY,{className:"text-left w-full text-sm font-semibold truncate",title:null!=(e=null==w?void 0:w.name)?e:"Me",children:null!=(t=null==w?void 0:w.name)?t:"Me"}),(0,a.jsxs)(b.ae,{children:[k?"Pro":N?"Hobby":I?"Free":"Trial"," Workspace"]})]})]})}),(0,a.jsxs)(g.pm,{align:"start",className:"w-56 space-y-2",children:[y.workspaces.length?(0,a.jsxs)(v.T,{children:[(0,a.jsx)(b.ae,{className:"font-medium ml-3 mb-1",children:"Workspaces"}),y.workspaces.map(e=>{var t,r,l;return(0,a.jsx)(z,{onSelect:()=>{C(e.id),null!=c&&s.replace({url:(0,o.Yk)()})},children:(0,a.jsx)(T,{selected:!D&&e.id===(null==w?void 0:w.id),name:null!=(r=null!=(t=e.name)?t:y.name)?r:"My Workspace",avatar:null!=(l=e.avatar)?l:y.avatar})},e.id)})]}):null,(0,a.jsx)(g.rx,{}),(0,a.jsx)(z,{onSelect:()=>s.push(r.newWorkspace({})),children:(0,a.jsxs)(v.z,{align:"center",space:3,children:[(0,a.jsx)(p.In,{icon:d.f5w,size:"md",className:"text-pink-500"}),(0,a.jsx)(b.EY,{className:"text-sm text-pink-500",children:"Create Workspace"})]})})]})]})})},M=e=>{let{children:t}=e,{workspace:r}=(0,o.hA)();return null==r?(0,a.jsx)(c.default,{}):(0,a.jsx)(k.n,{children:(0,a.jsxs)(j.N,{children:[(0,a.jsx)(v.T,{space:4,align:"start",className:"w-[240px]",children:(0,a.jsxs)(f.Bx,{className:"pt-0 md:!w-auto",children:[(0,a.jsx)(S,{}),(0,a.jsx)(N.S,{}),(0,a.jsx)(I.U,{})]})}),(0,a.jsx)(w.D,{children:(0,a.jsx)(y.F,{children:t})})]})})},T=e=>{let{name:t,avatar:r,email:s,selected:l}=e;return(0,a.jsxs)(v.z,{align:"center",space:3,className:"w-full",children:[(0,a.jsx)(x.e,{name:t,email:s,avatar:r,size:"xs"}),(0,a.jsx)(v.T,{className:"w-40",children:(0,a.jsx)(b.EY,{className:(0,h.xW)("text-sm truncate text-gray-600 ",l?"font-semibold":"font-normal"),title:t,children:t})})]})},z=(0,h.DR)(g.tJ)(C())},81009:(e,t,r)=>{"use strict";r.d(t,{M:()=>c});var s=r(50979),a=r(13025),l=r(25963),n=r(36609);let i={open:{opacity:1,height:"auto"},collapsed:{opacity:0,height:0}},o={duration:.25,ease:"easeInOut"},d=0,c=e=>{let{isOpen:t,children:r,className:c,...u}=e,m=(0,l.useMemo)(()=>"slidingContainer-".concat(d++),[]);return(0,s.jsx)(a.P.div,{"aria-controls":m,"aria-expanded":!!t,initial:t?"open":"collapsed",animate:t?"open":"collapsed",exit:"collapsed",variants:i,transition:o,style:{margin:t?void 0:0},...u,className:(0,n.xW)(c,t?"":"pointer-events-none"),children:r})}},82546:(e,t,r)=>{"use strict";r.d(t,{D:()=>l});var s=r(86739);function a(){let e=(0,s._)(["\n  flex flex-col items-center w-full min-w-0 min-h-lg pt-3\n"]);return a=function(){return e},e}let l=r(36609).qy.main(a())},83119:(e,t,r)=>{"use strict";r.d(t,{g$:()=>b,u7:()=>f,vm:()=>p});var s=r(50979),a=r(13075),l=r(91729),n=r(25963),i=r(25646),o=r(95662),d=r(42419),c=r(31754),u=r(70375),m=r(13077),h=r(2551),x=r(36609);let g=()=>{let{routes:e}=(0,u.c)();return(0,s.jsxs)(o.T,{className:"max-w-sm",space:4,children:[(0,s.jsxs)(o.T,{space:2,children:[(0,s.jsx)(d.EY,{className:"font-semibold",children:"Error"}),(0,s.jsx)(d.ax,{children:"Your build failed as we could not find a start command to run your deployment with."})]}),(0,s.jsxs)(o.z,{align:"center",justify:"end",space:2,children:[(0,s.jsx)(c.vx,{variant:"outline",size:"sm",color:"gray",...e.docs({page:"reference/errors/no-start-command-could-be-found"}),children:"Read the docs"}),(0,s.jsx)(c.vx,{size:"sm",...e.projectServiceSettings({section:"deploy-start-command"}),children:"Add a start command"})]})]})},p={"No start command was found":(0,s.jsx)(g,{}),"No start command could be found":(0,s.jsx)(g,{}),"Nixpacks was unable to generate a build plan for this app.":(0,s.jsx)(()=>{let{routes:e}=(0,u.c)();return(0,s.jsxs)(o.T,{className:"max-w-sm",space:4,children:[(0,s.jsxs)(o.T,{space:2,children:[(0,s.jsx)(d.EY,{className:"font-semibold",children:"Error"}),(0,s.jsx)(d.ax,{children:"This usually happens when using a monorepo without the correct root directory set."})]}),(0,s.jsxs)(o.z,{align:"center",justify:"end",space:2,children:[(0,s.jsx)(c.vx,{variant:"outline",size:"sm",...e.docs({page:"reference/errors/nixpacks-was-unable-to-generate-a-build-plan"}),children:"Read the docs"}),(0,s.jsx)(c.vx,{size:"sm",...e.projectServiceSettings({section:"root-directory"}),children:"Configure root directory"})]})]})},{}),"ENOTFOUND redis.railway.internal":(0,s.jsx)(()=>{let{routes:e}=(0,u.c)();return(0,s.jsxs)(o.T,{className:"max-w-sm",space:4,children:[(0,s.jsxs)(o.T,{space:2,children:[(0,s.jsx)(d.EY,{className:"font-semibold",children:"Error"}),(0,s.jsxs)(d.ax,{children:["Your deployment crashed because it could not resolve the",(0,s.jsx)(d.R0,{children:"redis.railway.internal"})," hostname to connect to your Redis instance."]})]}),(0,s.jsx)(o.z,{align:"center",justify:"end",space:2,children:(0,s.jsx)(c.vx,{size:"sm",...e.docs({page:"reference/errors/enotfound-redis-railway-internal"}),children:"Read the docs"})})]})},{})},v=RegExp("(".concat(Object.keys(p).join("|"),")"),"g"),b=e=>{let{content:t,className:r}=e;return(0,s.jsxs)("span",{className:(0,x.xW)("inline-flex items-center gap-2 py-1 px-2 bg-red-200 rounded-lg cursor-help",r),children:[(0,s.jsx)(d.tj,{children:t}),(0,s.jsx)(m.In,{icon:h.R2D,size:"sm"})]})},f=e=>{let{content:t}=e,r=(0,n.useMemo)(()=>t.split(v).map((e,t)=>p[e]?(0,s.jsx)(i.j,{triggerContent:(0,s.jsx)(b,{content:e}),cardContent:p[e]},t):(0,s.jsx)(n.Fragment,{children:(0,a.Ay)(e)},t)),[t]);return(0,s.jsx)(l.E,{children:r})}},91729:(e,t,r)=>{"use strict";r.d(t,{E:()=>l});var s=r(86739);function a(){let e=(0,s._)(["ansi-color-wrapper"]);return a=function(){return e},e}let l=r(36609).qy.span(a())}},e=>{e.O(0,[1209,6177,4834,4673,8593,4823,5449,1252,3587,8991,1758,1165,4966,407,1531,7562,701,1827,6376,636,6593,8792],()=>e(e.s=44364)),_N_E=e.O()}]);